{"ast":null,"code":"var _jsxFileName = \"/Users/oleksiimarchenko/Documents/React/webinars/webinar_26-09-2020/Project/Packman/src/components/Board/Board.js\";\nimport React, { Component } from \"react\";\nimport Pacman from \"../Pacman\";\nimport Ghost from \"../Ghost\";\nimport Food from \"../Food\";\nimport Finish from \"../Finish/Finish\";\nimport \"./style.css\";\n\nclass Board extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      packmanPosition: {\n        top: 0,\n        left: 0\n      },\n      ghostPosition: {\n        top: undefined,\n        left: undefined\n      },\n      isFinished: false,\n      score: undefined\n    };\n\n    this.lookForEat = () => {\n      const pacmanX = this.pacmanRef.current.state.position.left;\n      const pacmanY = this.pacmanRef.current.state.position.top;\n      const pacmanSize = this.pacmanRef.current.props.size;\n      const pacmanLastX = pacmanX + pacmanSize / 2;\n      const pacmanLastY = pacmanY + pacmanSize / 2;\n\n      for (let i = 0; i <= this.amountOfFood; i++) {\n        const currentFood = this[\"food\" + i].current;\n\n        if (currentFood) {\n          const currentFoodX = currentFood.state.position.left;\n          const currentFoodY = currentFood.state.position.top;\n          const currentFoodSize = currentFood.props.foodSize;\n          const currentFoodLastX = currentFoodX + currentFoodSize / 2;\n          const currentFoodLastY = currentFoodY + currentFoodSize / 2;\n\n          if (pacmanX >= currentFoodX && pacmanX <= currentFoodLastX || pacmanLastX >= currentFoodX && pacmanLastX <= currentFoodLastX) {\n            if (pacmanY >= currentFoodY && pacmanY <= currentFoodLastY || pacmanLastY >= currentFoodY && pacmanLastY <= currentFoodLastY) {\n              if (!currentFood.state.hidden) {\n                currentFood.ate();\n                this.props.setScore(value => value + 1);\n              }\n            }\n          }\n        }\n      }\n    };\n\n    this.getPackmanPosition = (top, left) => {\n      this.setState({\n        packmanPosition: {\n          top: top,\n          left: left\n        }\n      });\n      this.comparePosition();\n    };\n\n    this.getGhostPosition = (top, left) => {\n      this.setState({\n        ghostPosition: {\n          top: top,\n          left: left\n        }\n      });\n      this.comparePosition();\n    };\n\n    this.pacmanRef = React.createRef();\n    this.ghostRef = React.createRef();\n    this.foods = [];\n    this.amountOfFood = (window.innerWidth - this.props.foodSize) * (window.innerHeight - this.props.topScoreBoardHeight) / (this.props.foodSize * this.props.foodSize) - 1;\n\n    for (let i = 0; i < this.amountOfFood; i++) {\n      this[\"food\" + i] = React.createRef();\n    }\n  }\n\n  comparePosition() {\n    const {\n      top: topPackman,\n      left: leftPackman\n    } = this.state.packmanPosition;\n    const {\n      top: topGhost,\n      left: leftGhost\n    } = this.state.ghostPosition;\n\n    if (topPackman === topGhost && leftPackman === leftGhost) {\n      const score = localStorage.getItem(\"score\");\n      this.setState({\n        isFinished: true,\n        score: score\n      }); //TODO : ghostPosition - fixed\n\n      this.gh;\n    }\n  }\n\n  componentDidMount() {\n    this.intervalFood = setInterval(this.lookForEat, 100);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalFood);\n  }\n\n  render() {\n    const {\n      foodSize,\n      border,\n      topScoreBoardHeight\n    } = this.props;\n    let foods = [];\n    let currentTop = 0;\n    let currentLeft = 1 * foodSize;\n\n    for (let i = 0; i < this.amountOfFood; i++) {\n      if (currentLeft + foodSize >= window.innerWidth - border) {\n        currentTop += this.props.foodSize;\n        currentLeft = 0;\n      }\n\n      if (currentTop + foodSize >= window.innerHeight - border - topScoreBoardHeight) {\n        break;\n      }\n\n      const position = {\n        left: currentLeft,\n        top: currentTop\n      };\n      currentLeft += foodSize;\n      foods.push( /*#__PURE__*/React.createElement(Food, {\n        key: `food-elem-${i}`,\n        position: position,\n        ref: this[\"food\" + i],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 9\n        }\n      }));\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 7\n      }\n    }, this.state.isFinished ? /*#__PURE__*/React.createElement(Finish, {\n      score: this.state.score,\n      startNewGame: () => {\n        this.forceUpdate();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }\n    }) : null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"board\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }\n    }, foods, /*#__PURE__*/React.createElement(Pacman, {\n      ref: this.pacmanRef,\n      getPackmanPosition: this.getPackmanPosition,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(Ghost, {\n      ref: this.ghostRef,\n      color: \"blue\",\n      getGhostPosition: this.getGhostPosition,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 11\n      }\n    })));\n  }\n\n} // TODO: refactor and move to config\n\n\nBoard.defaultProps = {\n  foodSize: 50,\n  border: 10 * 2,\n  topScoreBoardHeight: 50\n};\nexport default Board;","map":{"version":3,"sources":["/Users/oleksiimarchenko/Documents/React/webinars/webinar_26-09-2020/Project/Packman/src/components/Board/Board.js"],"names":["React","Component","Pacman","Ghost","Food","Finish","Board","constructor","props","state","packmanPosition","top","left","ghostPosition","undefined","isFinished","score","lookForEat","pacmanX","pacmanRef","current","position","pacmanY","pacmanSize","size","pacmanLastX","pacmanLastY","i","amountOfFood","currentFood","currentFoodX","currentFoodY","currentFoodSize","foodSize","currentFoodLastX","currentFoodLastY","hidden","ate","setScore","value","getPackmanPosition","setState","comparePosition","getGhostPosition","createRef","ghostRef","foods","window","innerWidth","innerHeight","topScoreBoardHeight","topPackman","leftPackman","topGhost","leftGhost","localStorage","getItem","gh","componentDidMount","intervalFood","setInterval","componentWillUnmount","clearInterval","render","border","currentTop","currentLeft","push","forceUpdate","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Pacman from \"../Pacman\";\nimport Ghost from \"../Ghost\";\nimport Food from \"../Food\";\nimport Finish from \"../Finish/Finish\";\nimport \"./style.css\";\n\nclass Board extends Component {\n  state = {\n    packmanPosition: {\n      top: 0,\n      left: 0,\n    },\n    ghostPosition: {\n      top: undefined,\n      left: undefined,\n    },\n    isFinished: false,\n    score: undefined\n  };\n  constructor(props) {\n    super(props);\n    this.pacmanRef = React.createRef();\n    this.ghostRef = React.createRef();\n\n    this.foods = [];\n    this.amountOfFood =\n      ((window.innerWidth - this.props.foodSize) *\n        (window.innerHeight - this.props.topScoreBoardHeight)) /\n        (this.props.foodSize * this.props.foodSize) -\n      1;\n    for (let i = 0; i < this.amountOfFood; i++) {\n      this[\"food\" + i] = React.createRef();\n    }\n  }\n  comparePosition() {\n    const { top: topPackman, left: leftPackman } = this.state.packmanPosition;\n    const { top: topGhost, left: leftGhost } = this.state.ghostPosition;\n    if (topPackman === topGhost && leftPackman === leftGhost) {\n      const score = localStorage.getItem(\"score\");\n      this.setState({\n        isFinished: true,\n        score: score\n      });\n      //TODO : ghostPosition - fixed\n      this.gh\n    }\n  }\n  componentDidMount() {\n    this.intervalFood = setInterval(this.lookForEat, 100);\n  }\n  componentWillUnmount() {\n    clearInterval(this.intervalFood);\n  }\n  lookForEat = () => {\n    const pacmanX = this.pacmanRef.current.state.position.left;\n    const pacmanY = this.pacmanRef.current.state.position.top;\n    const pacmanSize = this.pacmanRef.current.props.size;\n\n    const pacmanLastX = pacmanX + pacmanSize / 2;\n    const pacmanLastY = pacmanY + pacmanSize / 2;\n\n    for (let i = 0; i <= this.amountOfFood; i++) {\n      const currentFood = this[\"food\" + i].current;\n      if (currentFood) {\n        const currentFoodX = currentFood.state.position.left;\n        const currentFoodY = currentFood.state.position.top;\n        const currentFoodSize = currentFood.props.foodSize;\n        const currentFoodLastX = currentFoodX + currentFoodSize / 2;\n        const currentFoodLastY = currentFoodY + currentFoodSize / 2;\n\n        if (\n          (pacmanX >= currentFoodX && pacmanX <= currentFoodLastX) ||\n          (pacmanLastX >= currentFoodX && pacmanLastX <= currentFoodLastX)\n        ) {\n          if (\n            (pacmanY >= currentFoodY && pacmanY <= currentFoodLastY) ||\n            (pacmanLastY >= currentFoodY && pacmanLastY <= currentFoodLastY)\n          ) {\n            if (!currentFood.state.hidden) {\n              currentFood.ate();\n              this.props.setScore((value) => value + 1);\n            }\n          }\n        }\n      }\n    }\n  };\n  getPackmanPosition = (top, left) => {\n    this.setState({\n      packmanPosition: {\n        top: top,\n        left: left,\n      },\n    });\n    this.comparePosition();\n  };\n  getGhostPosition = (top, left) => {\n    this.setState({\n      ghostPosition: {\n        top: top,\n        left: left,\n      },\n    });\n    this.comparePosition();\n  };\n\n  render() {\n    const { foodSize, border, topScoreBoardHeight } = this.props;\n    let foods = [];\n    let currentTop = 0;\n    let currentLeft = 1 * foodSize;\n    for (let i = 0; i < this.amountOfFood; i++) {\n      if (currentLeft + foodSize >= window.innerWidth - border) {\n        currentTop += this.props.foodSize;\n        currentLeft = 0;\n      }\n      if (\n        currentTop + foodSize >=\n        window.innerHeight - border - topScoreBoardHeight\n      ) {\n        break;\n      }\n\n      const position = { left: currentLeft, top: currentTop };\n      currentLeft += foodSize;\n      foods.push(\n        <Food\n          key={`food-elem-${i}`}\n          position={position}\n          ref={this[\"food\" + i]}\n        />\n      );\n    }\n\n    return (\n      <div className=\"container\">\n        {this.state.isFinished ? (\n          <Finish\n            score={this.state.score}\n            startNewGame={() => {\n              this.forceUpdate();\n            }}\n          />\n        ) : null}\n        <div className=\"board\">\n          {foods}\n          <Pacman\n            ref={this.pacmanRef}\n            getPackmanPosition={this.getPackmanPosition}\n          />\n          <Ghost ref={this.ghostRef} color=\"blue\" getGhostPosition={this.getGhostPosition} />\n        </div>\n      </div>\n    );\n  }\n}\n\n// TODO: refactor and move to config\nBoard.defaultProps = {\n  foodSize: 50,\n  border: 10 * 2,\n  topScoreBoardHeight: 50,\n};\n\nexport default Board;\n"]},"metadata":{},"sourceType":"module"}